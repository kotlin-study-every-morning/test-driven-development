**기본적인 전략에 관한 질문**

어떻게 테스트할 것인가에 대하여 자세히 이야기하기 전에 우선 기본적인 전략에 관한 질문에 답해야 한다

- 테스트한다는 것은 무엇을 뜻하는가?
- 테스트를 언제 해야 하는가?
- 테스트할 로직을 어떻게 고를 것인가?
- 테스트할 데이터를 어떻게 고를 것인가?

### 테스트(명사)

작성한 소프트웨어를 어떻게 테스트할 것인가? 자동화된 테스트를 만들어라

테스트하다(test)는 ‘평가하다’라는 뜻의 동사이다 아무리 작은 변화라도 테스트하지 않고 릴리즈하지는 않는다

당신이 변화를 테스트할 수 있다고 해도, 실제로 변화를 테스트하는 것은 ‘테스트를 갖고 있다’는 것과 똑같지 않다

**테스트 할 수 있음 ≠ 테스트를 가지고 있음**

어째서 명사로서의 테스트(자동으로 실행되는 과정)가 동사로서의 테스트(버튼을 몇 개 눌러보고 화면에 나오는 결과를 주시하는)와 다른 느낌들 주는걸까?

양성 피드백 고리처럼 일에 대한 영향도 때문에 스트레스를 많이 받아서 그렇다

![img.png](img.png)

고리를 빠져나오려면 ‘테스트’를 ‘자동화된 테스트’로 치환하면 된다
테스트를 실행하면 즉시 좋은 느낌을 받게 되고 그러면 작업 중에 에러를 낼 일도 줄게 되며, 스트레스도 적어진다

> 계속 가스라이팅 당하는 것 같다 테스트를 실행하면 좋긴함
그리고… 이 부분에서 뭘 말하고 싶은지 잘 모르겠다 일단은 느끼는대로 정리해보았음
>

### **격리된 테스트**

테스트를 실행하는 것이 서로 어떤 식으로 영향을 미쳐야 좋은가?
→ 아무 영향이 없어야 한다!

1. 테스트가 충분히 빨라서 내가 직접, 자주 실행할 수 있게끔 만들자
   그렇게 되면 내가 만든 에러를 다른 누구보다 먼저 내가 잡을 수 있고, 더 이상 악몽 같은 아침도 없다
2. 어마어마한 양의 종이더미가 반드시 어마어마한 양의 문제를 의미하는 것은 아니다
   앞 부분에서 실행된 테스트가 실패한 후 그 영향으로 다음 테스트 부터는 시스템이 예측 불가능한 상태에 놓이는 경우가 허다하다 (→ 그래서 분리)
3. 테스트는 전체 애플리케이션을 대상으로 하는 것보다 좀더 작은 스케일로 하는게 좋다
4. **각각의 테스트는 다른 테스트와 완전히 독립적이어야 한다는 것
   → 즉, 문제가 하나면 테스트도 하나만 실패해야하고, 문제가 둘이면 테스트도 두 개만 실패해야한다**

격리된 테스트가 내포하는 게 하나 더 있다

주어진 문제를 작은 단위로 분리하기 위해 노력해서(때론 매우 많은 노력) 각 테스트를 실행하기 위한 환경을 쉽고 빠르게 세팅할 수 있게 해야 한다는 것이다
테스트를 격리하기 위한 작업은 결과적으로 시스템이 응집도는 높고 결합도는 낮은 객체의 모음으로 구성되도록한다

### 테스트 목록

뭘 테스트해야 하나?

프로그래밍 스트레스를 줄이기 위한 우리 접근법의 첫 단계는
**발 디딜 곳이 확실해지기 전엔 결코 발을 떼어 전진하지 말자는 것이다** (정말 정말 공감합니다)

프로그래밍하기 위해 자리에 앉았을 때, 우리가 성취하고자 하는 것은 무엇인가?
목표에서 벗어나지 않고 집중할 수 있는 한 가지 전략은 모든 걸 머릿속에 넣어 두는 것이다

테스트 목록 짜기

1. 구현해야 할 것들에 대한 테스트를 목록에 적는다
2. 구현할 필요가 있는 모든 오퍼레이션의 사용 예들을 적는다
3. 이미 존재하지 않는 오퍼레이션에 대해서는 해당 오퍼레이션의 널 버전(아무 일도 하지 않는 버전)을 적는다
4. 깔끔한 코드를 얻기 위해 이번 작업을 끝내기 전에 반드시 해야할 리팩토링 목록을 적는다

### 테스트 우선

테스트를 언제 작성하는 것이 좋을까? 테스트 대상이 되는 코드를 작성하기 직전에 작성하는 것이 좋다

이유는 첫 장에 설명한 이유와 유사하다 (스트레스와 테스트)

### 단언 우선

단언(assert)은 제일 먼저 쓰고 시작하라. 자기유사성(self-similarity)이란 참 멋지지 않은가?

- 자기 유사성

  https://ko.wikipedia.org/wiki/자기유사성


- 시스템을 개발할 때 무슨 일부터 하는가? 완료된 시스템이 어떨 거라고 알려주는 이야기부터 작성한다
- 특정 기능을 개발할 때 무슨 일부터 하는가? 기능이 완료되면 통과할 수 있는 테스트부터 작성한다
- 테스트를 개발할 때 무슨 일부터 하는가? 완료될 때 통과해야 할 단언부터 작성한다

결국엔 단언이 먼저 나온다!

### 테스트 데이터

테스트할 때 어떤 데이터를 사용해야 하는가?

테스트를 읽을 때 쉽고 따라가기 좋을 만한 데이터를 사용하라 테스트 작성에도 청중이 존재한다

데이터 간에 차이가 있다면 그 속에 어떤 의미가 있어야 한다 1과 2 사이에 어떠한 개념적 차이점도 없다면 1을 사용하라

테스트 데이터 패턴이 완전한 확신을 얻지 않아도 되는 라이선스는 아니다
만약 시스템이 여러 입력을 다루어야 한다면 테스트 역시 여러 입력을 반영해야 한다
하지만 세 항목만으로 동일한 설계와 구현을 이끌어낼 수 있다면 굳이 항목을 열 개나 나열할 필요는 없다

테스트 데이터에 대한 대안은 실제 세상에서 얻어진 실제 데이터를 사용하는 것이다 실제 데이터는 다음과 같은 경우에 유용하다

- 실제 실행을 통해 수집한 외부 이벤트의 결과를 이용하여 실시간 시스템을 테스트하고자 하는 경우
- 예전 시스템의 출력과 현재 시스템의 출력을 비교하고자 하는 경우(병렬 테스팅)
- 시뮬레이션 시스템을 리팩토링한 후 기존과 정확히 동일한 결과가 나오는지 확인하고자 할 경우. 특히 부동소수점 값의 정확성이 문제가 될 수 있다

### 명백한 데이터

데이터의 의도를 어떻게 표현할 것인가? 테스트 자체에 예상되는 값과 실제 값을 표현하고 이 둘 사이의 관계를 드러내기 위해 노력하라
테스트를 작성할 때는 컴퓨터뿐 아니라 후에 코드를 읽을 다른 사람들도 생각해야 한다

수십년 후 누군가가 와서 “대체 이 자식이 뭔 생각으로 이 코드를 만든 거야?” 이 짜증내는 사람이 내 자신일 수도 있다…
