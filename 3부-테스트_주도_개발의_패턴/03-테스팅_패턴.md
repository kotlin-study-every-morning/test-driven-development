## 27장. 테스팅 패턴 ##

### 자식 테스트 ###

지나치게 큰 테스트를 어떻게 돌아가도록 할 수 있을까?

- > 원래 테스트 케이스의 깨지는 부분에 해당하는 작은 테스트 케이스를 작성하고 그 작은 테스트 케이스가 실행되도록 하라.

그 후에 다시 원래의 큰 테스트 케이스를 추가하라.

순차적인 단계를 유지 하도록 하자 (빨강 -> 초록 -> 리팩토링)

자신만의 방법을 찾을 것

### 모의 객체 ###

비용이 많이 들고 복잡한 리소스에 의존하는 객체를 테스트하려면 어떻게 해야하나?

- > 상수를 반환하게끔 속임수 버전의 리소스를 만들면 된다.

데이터베이스는 외부 요인에 의한 변수가 많다.

해법은 대부분의 경우 진짜 데이터 베이스를 사용하지 않는것.

성능과 견고함에 더해 모의 객체는 가독성이 더 좋다.

모의 객체가 진짜 객체와 동일하게 동작하지 않으면 어떻게 될까?

- 모의 객체용 테스트 집합을 진짜 객체가 사용 가능해질때 그대로 적용해서 위험을 줄임. 
    - → 안정화 되었을때 사용하라(?)

### 셀프 션트 self shunt ###

한 객체가 다른 객체와 올바르게 대화하는지 테스트하려면 어떻게 할까?

- > 테스트 대상이 되는 객체가 원래의 대화 상대가 아니라 테스트 케이스와 대화하도록 만들면 됨.

테스팅 사용자 인터페이스의 초록 막대를 동적으로 업데이트 상황

UI 객체를 TestResult와 연결할 수 있다면 테스트가 실행된 시점, 테스트가 실패한 시점,

전체 테스트슈트가 시작되고 끝난 시점 등을 통보 받을수 있을 것.

- 이러한 이벤트를 통보 받으면 인터페이스를 갱신하면 됨.

셀트 션트 패턴을 이용해 작성한 테스트가 그렇지 않은 테스트보다 읽기에 더 수월.

셀프 션트 패턴은 테스트 케이스가 구현할 인터페이스를 얻기 위해 인터페이스 추출 해야함.

셀프 션트를 위해 추출해 낸 인터페이스는 여러 곳에서 쓰이는 경우가 많음.

### 로그 문자열 ###

메시지의 호출 순서가 올바른지 검사하려면 어떻게 해야 할까?

- > 로그 문자열을 가지고 메시지가 호출될 때마다 그 문자열에 추가하도록 한다.

*메시지의 호출 : 메서드의 호출*

로그문자열은 옵저버 Observer를 구현하고 이벤트 통보가 원하는 순서대로 발생하는지 확인하고자 할때 유용하다.

로그 문자열을 셀프션트와도 잘 작동함.

### 크래시 테스트 더미 ###

호출되지 않을것 같은 에러코드(발생하기 힘든 에러)를 어떻게 테스트 할것인가?

- > 실제 작업을 수행하는 대신 예외만 발생시키기만 하는 특수한 객체를 만들어 이를 호출.

가짜 구현(fake it)을 통한 테스트 메서드를 구현한 가짜 클래스를 사용하거나,

익명 내부 클래스를 사용해 테스트하기 원하는 적절한 메서드만이 오류를 발생시키게끔 한다.

### 깨진 테스트 ###

혼자 프로그래밍 할때 프로그래밍 세션을 어떤 상태로 끝마치는게 좋을까?

- > 마지막 테스트가 깨진 상태로 끝마치는것이 좋다.

문장 중간까지만 써놓고 멈추는 트릭

다시 코딩을 시작 했을때 그 문장을 보고 무슨 생각을 했는지 떠올리기 더 쉽다.

### 깨끗한 체크인 ###

팀 프로그래밍을 할때 프로그래밍 세션을 어떤 상태로 끝마치는게 좋을까?

- > 모든 테스트가 성공한 상태로 끝마치는것이 좋다.

체크인 하기전 항상 모든 테스트가 돌아가는 상태로 만들어 두어야 한다.

- > 팀단위 작업에서는 직전까지 무슨일이 있었는지 알지 못하기 때문